
<div class="heading">
  <div class="lastUpdate">
    <span id="stationTime"></span>, <span id="stationDate"></span>
  </div>
  <div class="title">
    Meteo Fiobbio
  </div>
  <div id="stationInfo">
    Stazione a <span id="stationElevation"></span>&nbsp;, <span id="stationLatitude"></span>-<span id="stationLongitude"></span>
  </div>
  <!-- HEADER START -->
  <div style="font-size: 80%; padding-top: 0.5em;">
    Alba: <span id="sunriseTime"></span>, tramonto: <span id="sunsetTime"></span>.Fase lunare: <span id="moonPhase"></span>
  </div>
  <!-- HEADER END -->
</div>

<div>
  <ul id="genericMeasures" class="measures-container" style="display: none;">
    <li class="where"></li>
    <li class="measure">
      <label>Vento</label>
      <div>
        <div class="other">
          <div><span id="windGustSpeed"></span></div>
          <div class="sub">
            Raffica
          </div>
        </div>
        <div class="curr">
          <span id="windSpeed"></span><label class="unit"><span id="windUnit"></span></label>
          <div style="font-size:50%">
            <span id="windDirection"></span>&nbsp;<span id="windBeaufortScale"></span>
          </div>
        </div>
        <div class="max">
          <div><span id="hiWindSpeed"></span></div>
          <div class="sub"><span id="hiWindSpeedTime"></span></div>
        </div>
      </div>
    </li>

    <li class="measure">
      <label>Temperatura</label>
      <div>
        <div class="min">
          <div><span id="lowOutsideTemp"></span></div>
          <div class="sub"><span id="lowOutsideTempTime"></span></div>
        </div>
        <div class="curr">
          <span id="outsideTemp"></span><label class="unit">C</label>
          <div style="font-size: 50%;">
            Percepita &nbsp; <span id="apparentTemp"></span><label class="unit">C</label>
          </div>
        </div>
        <div class="max">
          <div><span id="hiOutsideTemp"></span></div>
          <div class="sub"><span id="hiOutsideTempTime"></span></div>
        </div>
      </div>
    </li>

    <li class="measure">
      <label>Umidit&agrave;</label>
      <div>
        <div class="min">
          <div><span id="lowHumidity"></span></div>
          <div class="sub"><span id="lowHumTime"></span></div>
        </div>
        <div class="curr">
          <span id="outsideHumidity"></span><label class="unit">%</label>
          <div style="font-size: 50%">&nbsp;</div>
        </div>
        <div class="max">
          <div><span id="hiHumidity"></span></div>
          <div class="sub"><span id="hiHumTime"></span></div>
        </div>
      </div>
    </li>

    <li class="measure">
      <label>Pressione</label>
      <div>
        <div class="min">
          <div><span id="lowBarometer"></span></div>
          <div class="sub"><span id="lowBarometerTime"></span></div>
        </div>
        <div class="curr">
          <span id="barometer"></span><label class="unit"><span id="barUnit"></span></label>
          <div style="font-size:50%">
            Tendenza&nbsp;<span id="baromtrend"></span>
          </div>
        </div>
        <div class="max">
          <div><span id="hiBarometer"></span></div>
          <div class="sub"><span id="hiBarometerTime"></span></div>
        </div>
      </div>
    </li>

    <li class="measure">
      <label>Pioggia</label>
      <div>
        <div class="other">
          <div>
            <span id="dailyRain"></span>
          </div>
          <div class="sub">
            mm totali
          </div>
        </div>
        <div class="curr">
          <span id="rainRate"></span><label class="unit"><span id="rateUnit"></span></label>
          <div style="font-size:50%">
          </div>
        </div>
        <div class="max">
          <div><span id="stormRain"></span></div>
        </div>
      </div>
    </li>
  </ul> <!-- measures-container -->

  <ul id="fiobbioMeasures" class="measures-container"></ul>
  <ul id="mismaMeasures" class="measures-container"></ul>

</div>

<div>
  <ul class="webcams-container">
    <li>
      <a href="http://rete.centrometeolombardo.com/bergamo/fiobbio/public/webcam.jpg" data-featherlight="image">
        <img class="webcam" alt="webcam_small" src="http://rete.centrometeolombardo.com/bergamo/fiobbio/public/webcam_small.jpg" />
      </a>
    </li>
    <li>
      <a href="http://rete.centrometeolombardo.com/bergamo/montemisma/public/webcam.jpg" data-featherlight="image">
        <img class="webcam" alt="webcam_small" src="http://rete.centrometeolombardo.com/bergamo/montemisma/public/webcam_small.jpg" />
      </a>
    </li>
  </ul>
</div>

<div class="blockdisplay">
  <ul class="graph-container">
    <li>
      <img class="wviewgraph" alt="wview image" src="tempdaycomp.png">
    </li>
    <li>
      <img alt="wview image" src="wspeeddaycomp.png">
    </li>
    <li>
      <img alt="wview image" src="radiationDay.png ">
    </li>
  </ul>

  <ul class="graph-container">
    <li>
      <img alt="wview image" src="rainday.png">
    </li>
    <li>
      <img alt="wview image" src="baromday.png">
    </li>
    <li>
      <img alt="wview image" src="humidday.png">
    </li>
  </ul>

  <ul class="graph-container">
    <li>
      <img class="wviewbar" alt="wview image" src="radiation.png">
    </li>
    <li>
      <img class="wviewbar" alt="wview image" src="dayrain.png">
    </li>
    <li>
      <img class="wviewbar" alt="wview image" src="stormrain.png">
    </li>
    <li>
      <img class="wviewbar" alt="wview image" src="rainrate.png">
    </li>
    <li>
      <img class="wviewbar" alt="wview image" src="monthrain.png">
    </li>
    <li>
      <img class="wviewbar" alt="wview image" src="yearrain.png">
    </li>
  </ul>
  <ul class="graph-container">
    <li>
      <img class="round" alt="wview image" src="windroseday.png">
    </li>
    <li>
      <img class="round" alt="wview image" src="windroseweek.png">
    </li>
    <li>
      <img class="round" alt="wview image" src="windroseyear.png">
    </li>
  </ul>
</div>
<!-- WEATHER IMAGES END -->

<script>
  function populateStationInfo() {
      $.ajax({
        url      : "stationinfo.json",
        dataType : "json"
      }).done( (data) => {

        // we map 1:1 json key value with id name,
        // so that data loading is trivial!
        $.each(data, (key, val) => {
          $("#" + key).text(val);
        });
      });
  }

  function populateMeasures(locs) {

    locs.forEach((loc) => {
      $.ajax({

        url      : loc.url,
        dataType : "json"

      }).done( (data) => {

        $("#" + loc.tgtId).html($("#genericMeasures").html());

        $("#" + loc.tgtId + " .where").text(loc.where);

        // we map 1:1 json key value with id name,
        // so that data loading is trivial!
        $.each(data, (key, val) => {
          $("#" + loc.tgtId + " #" + key).text(val);
        });

      }); // ajax..done

    }); // forEach
  }

  $(document).ready(() => {
    const locations = [
      { url   : "realtime.json" ,
        tgtId : "fiobbioMeasures",
        where : "Paese"},
      { url   : "/misma/realtime.json",
        tgtId : "mismaMeasures",
        where : "Misma"
      }
    ];

    populateStationInfo();
    populateMeasures(locations);
  });

</script>
