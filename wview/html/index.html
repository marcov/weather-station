<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Meteo, Webcam e Previsioni Fiobbio di Albino</title>
  <meta name="description"
     content="Dati in tempo reale delle stazioni meteo di Fiobbio di Albino e
              del Monte Misma.
              Immagini in diretta webcam Fiobbio di Albino.
              Immagini in diretta webcam Monte Misma.
              Previsioni meteo per Albino (BG).
              Archivio dati meteo di Albino.
              Fiobbio Ã¨ un paese situato nella Valle del Lujo,
              nella media Val Seriana, in provincia di Bergamo, Lombardia. ">

  <!-- the following is needed for the media queries to work correctly -->
  <meta name="viewport" content="width=device-width">
  <link type="text/css" rel="stylesheet" href="css/layout.css" />
  <link type="text/css" rel="stylesheet" href="css/featherlight.min.css" />
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Inconsolata|Major+Mono+Display|Share+Tech+Mono|Oxygen+Mono|Baloo+Tamma+2:wght@400;700;800">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KCSTMYF26E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-KCSTMYF26E');
  </script>

  <!-- AdSense
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8303716244658891"
     crossorigin="anonymous"></script>
  -->
</head>

<body>
  <div class="maincolumn">

    <div class="heading">
      <ul>
          <li class="title"> <h1>Meteo Fiobbio </h1></li>
      </ul>

      <p class="heading-separator"> | </p>

      <ul class="links">
        <li>
        <a href="/grafana/d/Ewu-ii3Mk/wview-fiobbio1-vs-fiobbio2?orgId=1&kiosk">Dettagli</a>
        </li>
        <li> &nbsp;&#8211;&nbsp; </li>
        <li>
        <a href="/grafana/d/-qh9KGzRk/wview-past-years-comparison-fiobbio-and-misma?orgId=1&kiosk">Serie Storiche</a>
        </li>
        <li> &nbsp;&#8211;&nbsp; </li>
        <a href="html/archive.html" class="indented">Archivio</a>
        </li>
        <li> &nbsp;&#8211;&nbsp; </li>
        <li>
        <a href="mailto:marcelloalborghetti@gmail.com,marco.vedovati@gmail.com">Contatti</a>
        </li>
        <!--
        <a href="/fiobbio2">Fiobbio 2</a>
        &nbsp;&#8211;&nbsp;
        <a href="/misma">Mt. Misma</a>
        &nbsp;&#8211;&nbsp;
        <a href="almanac.htm" class="indented">Almanacco</a>
        &nbsp;&#8211;&nbsp;
        <a href="Daily.htm" class="indented">24h</a>
        &nbsp;&#8211;&nbsp;
        <a href="Monthly.htm" class="indented">Mese in corso</a>
        &nbsp;&#8211;&nbsp;
        <a href="Yearly.htm" class="indented">Anno in corso</a>
        &nbsp;&#8211;&nbsp;
        -->
      </ul>

      <p class="heading-separator"> | </p>

      <ul class="stationData">
        <li> &#9650; <span id="stationElevation"></span> </li>
        <li> &nbsp;&#8211;&nbsp; </li>

        <li>
          <span id="stationLatitude"></span>&#8210;<span id="stationLongitude"></span>
        </li>
        <li> &nbsp;&#8211;&nbsp; </li>

        <li>
          &UpperRightArrow;<span id="sunriseTime"></span>&nbsp;&LowerRightArrow;<span id="sunsetTime"></span>
        </li>
        <li> &nbsp;&#8211;&nbsp; </li>

        <li>
            &#9789; <span id="moonPhase"></span>
        </li>
      </ul>

    </div>

    <div class="measures-container">
      <!-- NOTE: this is actually just a template, being used for the 2 containers below -->
      <ul id="measuresTemplate" class="measures-group" style="display: none;">

        <li class="" style="min-width: 10rem;">
          <!-- placeholder label to a correct flex layout -->
          <label class="emptyLabel">&nbsp;</label>
          <div>
              <a class="location"></a>&nbsp;-&nbsp;<label class="timestamp"></label>
          </div>
        </li>

        <li class="measure">
          <label>Temperatura (&deg;C)</label>
          <div>
            <div class="min">
              <div><span class="lowOutsideTemp"></span></div>
              <div class="sub"><span class="lowOutsideTempTime"></span></div>
            </div>
            <div class="curr tempCurr">
              <span class="outsideTemp"></span>
              <span style="font-size: 50%;"> Feels&nbsp;</span><span style="font-size: 60%;" class="apparentTemp"></span>
            </div>
            <div class="max">
              <div><span class="hiOutsideTemp"></span></div>
              <div class="sub"><span class="hiOutsideTempTime"></span></div>
            </div>
          </div>
        </li>

        <li class="measure">
          <label>Vento (km/h)</label>
          <div>
            <div class="other">
              <div><span class="windGustSpeed"></span></div>
              <div class="sub">
                Raff
              </div>
            </div>
            <div class="curr">
              <span class="windSpeed"></span>
              <div class="sub" style="font-size:50%">
              Dir <span class="windDirection"></span>
              </div>
            </div>
            <div class="max">
              <div><span class="hiWindSpeed"></span></div>
              <div class="sub"><span class="hiWindSpeedTime"></span></div>
            </div>
          </div>
        </li>

        <li class="measure">
          <label>Umidit&agrave; (%)</label>
          <div>
            <div class="min">
              <div><span class="lowHumidity"></span></div>
              <div class="sub"><span class="lowHumTime"></span></div>
            </div>
            <div class="curr narrow">
              <span class="outsideHumidity"></span>
              <div style="font-size: 50%">&nbsp;</div>
            </div>
            <div class="max">
              <div><span class="hiHumidity"></span></div>
              <div class="sub"><span class="hiHumTime"></span></div>
            </div>
          </div>
        </li>

    <!--
        <li class="measure">
          <label>Pressione</label>
          <div>
            <div class="min">
              <div><span class="lowBarometer"></span></div>
              <div class="sub"><span class="lowBarometerTime"></span></div>
            </div>
            <div class="curr">
              <span class="barometer"></span><label class="unit"><span class="barUnit"></span></label>
              <div style="font-size:50%">
                Tendenza&nbsp;<span class="baromtrend"></span>
              </div>
            </div>
            <div class="max">
              <div><span class="hiBarometer"></span></div>
              <div class="sub"><span class="hiBarometerTime"></span></div>
            </div>
          </div>
        </li>
    -->

        <li class="measure">
          <label>Pioggia (mm/h)</label>
          <div>
            <div class="other">
              <div>
                <span class="dailyRain"></span>
              </div>
              <div class="sub">
                Accum
              </div>
            </div>
            <div class="curr">
              <span class="rainRate"></span>
              <div style="font-size:50%">
              </div>
            </div>
            <div class="max">
              <div>
                <span class="stormRain"></span>
              </div>
              <div class="sub">
                Storm
              </div>
            </div>
          </div>
        </li>
      </ul> <!-- measures-group -->

      <ul id="fiobbio1Measures" class="measures-group"></ul>
      <ul id="fiobbio2Measures" class="measures-group"></ul>
      <ul id="mismaMeasures" class="measures-group"></ul>

    </div> <!-- <div class="measures-container"> -->

    <div>
      <ul class="webcams-container">
        <!-- CML does not use HTTPS :-O :-( :-X
        <li>
          <a href="http://rete.centrometeolombardo.com/bergamo/fiobbio/public/webcam.jpg" data-featherlight="image">
            <img class="webcam" alt="webcam_small" src="http://rete.centrometeolombardo.com/bergamo/fiobbio/public/webcam_small.jpg" />
          </a>
        </li>
        <li>
          <a href="http://rete.centrometeolombardo.com/bergamo/montemisma/public/webcam.jpg" data-featherlight="image">
            <img class="webcam" alt="webcam_small" src="http://rete.centrometeolombardo.com/bergamo/montemisma/public/webcam_small.jpg" />
          </a>
        </li>
        -->

        <li>
          <a href="/webcam/webcam_fiobbio.jpg" data-featherlight="image">
            <img class="webcam" alt="webcam_small" src="/webcam/webcam_small_fiobbio.jpg" />
          </a>
        </li>
        <li>
          <a href="/webcam/webcam_misma.jpg" data-featherlight="image">
            <img class="webcam" alt="webcam_small" src="/webcam/webcam_small_misma.jpg" />
          </a>
        </li>
      </ul>
    </div>

    <!-- credits: https://css-tricks.com/infinite-all-css-scrolling-slideshow/ -->
    <div class="panorama-scroll" style="display:none;">
      <!-- <div class="sliding-background"></div> -->
      <div class="still-background"></div>
    </div>

    <div>
      <ul class="graph-container">
        <li>
          <img class="wviewgraph" alt="wview image" src="tempdaycomp.png">
        </li>
        <li>
          <img alt="wview image" src="wspeeddaycomp.png">
        </li>
        <li>
          <img alt="wview image" src="radiationDay.png ">
        </li>
      </ul>

      <ul class="graph-container">
        <li>
          <img alt="wview image" src="rainday.png">
        </li>
        <li>
          <img alt="wview image" src="baromday.png">
        </li>
        <li>
          <img alt="wview image" src="humidday.png">
        </li>
      </ul>

      <!-- All radiation + rain -->
      <ul class="graph-container" style="display:none;">
        <li>
          <img class="wviewbar" alt="wview image" src="radiation.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="dayrain.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="stormrain.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="rainrate.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="monthrain.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="yearrain.png">
        </li>
      </ul>

      <!-- All wind -->
      <ul class="graph-container" style="display:none;">
        <li>
          <img class="round" alt="wview image" src="windroseday.png">
        </li>
        <li>
          <img class="round" alt="wview image" src="windroseweek.png">
        </li>
        <li>
          <img class="round" alt="wview image" src="windroseyear.png">
        </li>
      </ul>

      <!-- Wind / rain mix -->
      <ul class="graph-container">
        <li>
          <img class="round" alt="wview image" src="windroseday.png">
        </li>

        <li>
          <img class="wviewbar" alt="wview image" src="dayrain.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="monthrain.png">
        </li>
        <li>
          <img class="wviewbar" alt="wview image" src="yearrain.png">
        </li>

        <li>
          <img class="round" alt="wview image" src="windroseyear.png">
        </li>
      </ul>

    </div>
    <!-- WEATHER IMAGES END -->

    <div>
        <div class="bottombanner">
          <span style="font-weight: bold;">Marcello Alborghetti</span>
          <span style="font-size:80%;">&nbsp;(HW)&nbsp; - &nbsp;</span>
          <span style="font-weight: bold; font-size:102%; letter-spacing:.15rem;">Marco Vedovati</span>
          <span style="font-size:80%;">&nbsp;(SW)</span>
        </div>
    </div>

    <h3>Previsioni Meteo</h3>
    <ul class="flex-container">
      <li>
        <a href="https://www.meteoblue.com/en/weather/week/albino_italy_3183316/" title="Large image">
          <img style="height: 15em;" src="/webshot/meteoblue.jpg" alt="Meteoblue 7 days" title="Meteoblue 7 days" />
        </a>
      </li>
    </ul>

    <ul class="flex-container">
      <li>
        <a href="http://www.wetterzentrale.de/en/show_diagrams.php?geoid=76406&model=ecm&var=93&run=0&lid=OP&bw=" title="Large image">
          <img class="forecast-img" src="/webshot/wz_meteogram.jpg" alt="Meteogram 10d wetterzentrale" title="Meteogram 10d" />
        </a>
      </li>

      <li>
        <a href="https://www.wetterzentrale.de/en/show_diagrams.php?geoid=76406&model=ecm&var=201&run=12&lid=ENS&bw=" title="Large image">
          <img class="forecast-img" src="/webshot/wz_ensemble.jpg" alt="Meteogram 10d wetterzentrale" title="Ensemble 10d" />
        </a>
      </li>
    </ul>

    <h3>Immagini Satellitari</h3>
    <ul class="flex-container">
      <li>
        <a href="https://www.sat24.com/images.php?country=alps&sat=&1198352062421" title="Large image" data-featherlight="image">
          <img alt="sat24.com" class="satellite" src="https://www.sat24.com/images.php?country=alps&sat=&1198352062421" title="Small image" />
        </a>
      </li>
      <li>
        <a href="https://eumetview.eumetsat.int/static-images/latestImages/EUMETSAT_MSG_RGBNatColour_CentralEurope.jpg" title="Large image" data-featherlight="image">
          <img class="satellite" alt="eumetsat.org" src="https://eumetview.eumetsat.int/static-images/latestImages/EUMETSAT_MSG_RGBNatColour_CentralEurope.jpg" title="Small image" />
        </a>
      </li>
      <li>
        <a href="https://www.sat24.com/image.ashx?country=eu&type=zoom&format=640x480001001&sat=ir" title="Large image" data-featherlight="image">
          <img class="satellite" alt="sat24.com" src="https://www.sat24.com/image.ashx?country=eu&type=zoom&format=640x480001001&sat=ir" title="Small image" />
        </a>
      </li>
    </ul>

    <h3>Radar Meteo</h3>
    <ul class="flex-container">
      <li>
        <!--
        <a href="http://sc05.arpa.piemonte.it/previ/last_movie_compa.gif" title="Large image" data-featherlight="image">
          <img class="satellite" alt="arpa.piemonte.it" src="http://sc05.arpa.piemonte.it/previ/last_movie_compa.gif" title="EMCWF 500hPa" />
        </a>
        -->
        <a href="/webshot/radar_lom.jpg" title="Large image" data-featherlight="image">
          <img class="satellite" alt="radar cml" src="/webshot/radar_lom.jpg" title="radar cml" />
        </a>
      </li>
      <!--
      <li>
        <a href="radar_ch.png" title="Large image" data-featherlight="image">
          <img class="satellite" alt="radar met" src="radar_ch.png" title="radar met" />
        </a>
      </li>
      <li>
        <a href="radar_ch_detailed.png" title="Large image" data-featherlight="image">
          <img class="satellite" alt="radar met zoomed" src="radar_ch_detailed.png" title="radar met zoomed" />
        </a>
      </li>

    </ul>

    <ul class="flex-container">
      -->
      <li>
        <a href="http://www.meteox.com/images.aspx?jaar=-3&voor=&soort=loop3uur" title="Large image" data-featherlight="image">
          <img alt="clouds" class="satellite" src="http://www.meteox.com/images.aspx?jaar=-3&voor=&soort=loop3uur" title="Clouds" />
        </a>
      </li>
      <li>
        <a href="http://www.astrogeo.va.it/fulmini/fulmini.jpg" title="Large image" data-featherlight="image">
          <img alt="va.it" class="satellite" src="http://www.astrogeo.va.it/fulmini/fulmini.jpg" title="EMCWF 500hPa" />
        </a>
      </li>
    </ul>
  </div>
  <!-- div..maincolumn -->

  <script src="js/jquery-3.3.1.min.js"></script>

  <script src="js/featherlight.min.js"></script>

  <script>
    $(function() {
      $.featherlight.defaults.loading = "Caricamento immagine in corso...";
    });
  </script>

  <script>
    $(() => {
      function populateStationInfo() {
          $.ajax({
            url      : "stationinfo.json",
            dataType : "json"
          }).done( (jsonData) => {
            // we map 1:1 json key value with id name,
            // so that jsonData loading is trivial!
            $.each(jsonData, (key, val) => {
              $("#" + key).text(val);
            });
          });
      }

      function isToday(dateString) {
        let today = new Date();
        let dateTokens = dateString.split('/');

        let dd = parseInt(dateTokens[0]);
        let mm = parseInt(dateTokens[1]);
        let yy = parseInt(dateTokens[2]);

        return (today.getDate() == dd &&
                (today.getMonth() + 1) == mm &&
                (today.getFullYear() % 100) == yy);
      }

      function populateMeasures(locs) {
        locs.forEach((loc) => {
          $.ajax({
            url      : loc.Path + "realtime.json",
            dataType : "json"
          }).done( (jsonData) => {
            // Copy the HTML template into the actual element ID with the given tgtId
            $("#" + loc.tgtId).html($("#measuresTemplate").html());

            $("#" + loc.tgtId + " .location").text(loc.location);
            $("#" + loc.tgtId + " .location").attr('href', loc.Path);

            // Strip out seconds
            jsonData.timestamp = jsonData.stationTime.split(':', 2).join(':');

            // if not today, append full date
            if (!isToday(jsonData.stationDate)) {
              jsonData.timestamp += ' - ' + jsonData.stationDate;
            }

            // we map 1:1 json key value with id name,
            // so that jsonData loading is trivial!
            $.each(jsonData, (key, val) => {
              $("#" + loc.tgtId + " ." + key).text(val);
              if (key == 'timestamp') {
                //$("#" + loc.tgtId + " ." + key).css("background-color","green");
              }
            });
          }); // ajax..done
        }); // forEach
      }

      $(document).ready(() => {
        const locations = [
          {
            Path   : "/fiobbio1/",
            tgtId : "fiobbio1Measures",
            location : "Fiobbio 1"
          },
          {
            Path   : "/misma/",
            tgtId : "mismaMeasures",
            location : "Misma"
          },
          {
            Path   : "/fiobbio2/",
            tgtId : "fiobbio2Measures",
            location : "Fiobbio 2"
          }
        ];

        populateStationInfo();
        populateMeasures(locations);
      });
    });
  </script>

</body>

</html>
